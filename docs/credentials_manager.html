<html><head>
        <META http-equiv="content-type" content="text/html; charset=utf-8">
        <title>botan.tls.credentials_manager</title>
        </head><body>
        <h1>botan.tls.credentials_manager</h1>
        <!-- Generated by Ddoc from source/botan/tls/credentials_manager.d -->
Credentials Manager
<br><br>
<b>License:</b><br>
Botan is released under the Simplified BSD License (see LICENSE.md)<br><br>

<dl><dt><big><a name="TLSCredentialsManager"></a>abstract class <u>TLSCredentialsManager</u>;
</big></dt>
<dd>Interface for a credentials manager.
<br><br>
A type is a fairly static value that represents the general nature
 of the transaction occuring. Currently used values are "tls-client"
 and "tls-server". Context represents a hostname, email address,
 username, or other identifier.<br><br>

<dl><dt><big><a name="TLSCredentialsManager.trustedCertificateAuthorities"></a>abstract Vector!CertificateStore <u>trustedCertificateAuthorities</u>(in string <i>type</i>, in string <i>context</i>);
</big></dt>
<dd>Return a list of the certificates of CAs that we trust in this
 <i>type</i>/<i>context</i>.
<br><br>
<b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>. For instance
          for <i>type</i> "tls-client", <i>context</i> specifies the servers name.</td></tr>
</table><br>

</dd>
<dt><big><a name="TLSCredentialsManager.verifyCertificateChain"></a>abstract void <u>verifyCertificateChain</u>(in string <i>type</i>, in string <i>purported_hostname</i>, ref const Vector!X509Certificate <i>cert_chain</i>);
</big></dt>
<dd>Check the certificate chain is valid up to a trusted root, and
 optionally (if hostname != "") that the hostname given is
 consistent with the leaf certificate.
<br><br>
This function should throw new an exception derived from
  with an informative what() result if the
 certificate chain cannot be verified.

<br><br>
<b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>purported_hostname</i></td>
<td>specifies the purported hostname</td></tr>
<tr><td>Vector!X509Certificate <i>cert_chain</i></td>
<td>specifies a certificate chain leading to a
          trusted root CA certificate.</td></tr>
</table><br>

</dd>
<dt><big><a name="TLSCredentialsManager.certChain"></a>abstract Vector!X509Certificate <u>certChain</u>(ref const Vector!string <i>cert_key_types</i>, in string <i>type</i>, in string <i>context</i>);
<br>final Vector!X509Certificate <u>certChain</u>(T : string[])(auto ref T <i>cert_key_types</i>, in string <i>type</i>, in string <i>context</i>);
</big></dt>
<dd>Return a cert chain we can use, ordered from leaf to root,
 or else an empty vector.
<br><br>
It is assumed that the caller can get the private key of the
 leaf with Private_Keyfor

<br><br>
<b>Params:</b><br>
<table><tr><td>Vector!string <i>cert_key_types</i></td>
<td>specifies the key types desired ("RSA",
                              "DSA", "ECDSA", etc), or empty if there
                              is no preference by the caller.</td></tr>
<tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
</table><br>

</dd>
<dt><big><a name="TLSCredentialsManager.certChainSingleType"></a>abstract Vector!X509Certificate <u>certChainSingleType</u>(in string <i>cert_key_type</i>, in string <i>type</i>, in string <i>context</i>);
</big></dt>
<dd>Return a cert chain we can use, ordered from leaf to root,
 or else an empty vector.
<br><br>
It is assumed that the caller can get the private key of the
 leaf with Private_Keyfor

<br><br>
<b>Params:</b><br>
<table><tr><td>string <i>cert_key_type</i></td>
<td>specifies the <i>type</i> of key requested
                             ("RSA", "DSA", "ECDSA", etc)</td></tr>
<tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
</table><br>

</dd>
<dt><big><a name="TLSCredentialsManager.privateKeyFor"></a>abstract PrivateKey <u>privateKeyFor</u>(in X509Certificate <i>cert</i>, in string <i>type</i>, in string <i>context</i>);
</big></dt>
<dd><b>Params:</b><br>
<table><tr><td>X509Certificate <i>cert</i></td>
<td>as returned by cert_chain</td></tr>
<tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
</table><br>
<b>Returns:</b><br>
private key associated with this certificate if we should
            use it with this <i>context</i>.

<br><br>
<b>Notes:</b><br>
this object should retain ownership of the returned key;
         it should not be deleted by the caller.<br><br>

</dd>
<dt><big><a name="TLSCredentialsManager.attemptSrp"></a>abstract bool <u>attemptSrp</u>(in string <i>type</i>, in string <i>context</i>);
</big></dt>
<dd><b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
</table><br>
<b>Returns:</b><br>
<b>true</b> if we should attempt SRP authentication<br><br>

</dd>
<dt><big><a name="TLSCredentialsManager.srpIdentifier"></a>abstract string <u>srpIdentifier</u>(in string <i>type</i>, in string <i>context</i>);
</big></dt>
<dd><b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
</table><br>
<b>Returns:</b><br>
identifier for client-side SRP auth, if available
                 for this <i>type</i>/<i>context</i>. Should return empty string
                 if password auth not desired/available.<br><br>

</dd>
<dt><big><a name="TLSCredentialsManager.srpPassword"></a>abstract string <u>srpPassword</u>(in string <i>type</i>, in string <i>context</i>, in string <i>identifier</i>);
</big></dt>
<dd><b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
<tr><td>string <i>identifier</i></td>
<td>specifies what <i>identifier</i> we want the
          password for. This will be a value previously returned
          by srp_identifier.</td></tr>
</table><br>
<b>Returns:</b><br>
password for client-side SRP auth, if available
                 for this <i>identifier</i>/<i>type</i>/<i>context</i>.<br><br>

</dd>
<dt><big><a name="TLSCredentialsManager.srpVerifier"></a>abstract bool <u>srpVerifier</u>(in string <i>type</i>, in string <i>context</i>, in string <i>identifier</i>, ref string <i>group_name</i>, ref BigInt <i>verifier</i>, ref Vector!ubyte <i>salt</i>, bool <i>generate_fake_on_unknown</i>);
</big></dt>
<dd>Retrieve SRP <i>verifier</i> parameters<br><br>

</dd>
<dt><big><a name="TLSCredentialsManager.pskIdentityHint"></a>abstract string <u>pskIdentityHint</u>(in string <i>type</i>, in string <i>context</i>);
</big></dt>
<dd><b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
</table><br>
<b>Returns:</b><br>
the PSK identity hint for this <i>type</i>/<i>context</i><br><br>

</dd>
<dt><big><a name="TLSCredentialsManager.pskIdentity"></a>abstract string <u>pskIdentity</u>(in string <i>type</i>, in string <i>context</i>, in string <i>identity_hint</i>);
</big></dt>
<dd><b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
<tr><td>string <i>identity_hint</i></td>
<td>was passed by the server (but may be empty)</td></tr>
</table><br>
<b>Returns:</b><br>
the PSK identity we want to use<br><br>

</dd>
<dt><big><a name="TLSCredentialsManager.psk"></a>abstract SymmetricKey <u>psk</u>(in string <i>type</i>, in string <i>context</i>, in string <i>identity</i>);
</big></dt>
<dd><b>Params:</b><br>
<table><tr><td>string <i>type</i></td>
<td>specifies the <i>type</i> of operation occuring</td></tr>
<tr><td>string <i>context</i></td>
<td>specifies a <i>context</i> relative to <i>type</i>.</td></tr>
<tr><td>string <i>identity</i></td>
<td>is a PSK <i>identity</i> previously returned by
                psk_identity for the same <i>type</i> and <i>context</i>.</td></tr>
</table><br>
<b>Returns:</b><br>
the PSK used for <i>identity</i>, or throw new an exception if no
 key exists<br><br>

</dd>
</dl>
</dd>
</dl>

        <hr><small>Page generated by <a href="http://dlang.org/ddoc.html">Ddoc</a>. (C) 2011,2012 Jack Lloyd
 (C) 2014-2015 Etienne Cimon

</small>
        </body></html>
